<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>styx</title>
		<link href="jsoneditor.min.css" rel="stylesheet" type="text/css" />
		<script src="jsoneditor.min.js"></script>
	</head>
	<style>
		main {
			display: flex;
			flex-direction: row;
		}

		.jsoneditor-poweredBy {
			display: none;
		}

		.jsoneditor-search {
			display: none;
		}
	</style>
	<body>
		<h1>Styx</h1>
		<h2>Query</h2>
		<main>
			<div id="query" style="width: 420px; height: 420px;"></div>
			<button id="execute">query</button>
			<div id="result" style="width: 840px; height: 420px;"></div>
		</main>
		<script>
			// create the editor
			const queryContainer = document.getElementById("query")
			const queryEditor = new JSONEditor(queryContainer, {
				mode: "code",
				modes: [],
			})

			// set json
			queryEditor.set({
				"@context": {
					"@vocab": "http://schema.org/",
					parent: { "@reverse": "children" },
				},
				"@type": "Person",
				birthDate: {},
				parent: {
					name: "Joel",
				},
			})

			const resultContainer = document.getElementById("result")
			const resultEditor = new JSONEditor(resultContainer, {
				mode: "view",
				modes: [],
			})

			const button = document.getElementById("execute")
			button.addEventListener("click", () => {
				const body = JSON.stringify(queryEditor.get())
				console.log("got body", body)
				fetch("/query", { method: "POST", body })
					.then(res => res.json())
					.then(json => {
						resultEditor.set(json)
						resultEditor.expandAll()
					})
			})
		</script>
	</body>
</html>
